---
title: "Enlgish Dataset Analysis"
author: "Joel Ramirez Jr"
date: "7/1/2020"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo = FALSE, message = FALSE}
library(tidyverse)
library(readxl)
library(ppcor)
library(gridExtra)
```


```{r, echo = FALSE, message = FALSE}
hourlyOrdered16 <- read_csv("../4.Data/TL3Data/proportionValues/hourlyOrdredAwc16.csv") 
hourlyProp16 <- read_csv("../4.Data/TL3Data/proportionValues/hourlyProportions.csv")
segOrdered16 <- read_csv("../4.Data/TL3Data/proportionValues/segOrdredAwc16.csv") 
segProp16 <- read_csv("../4.Data/TL3Data/proportionValues/segProportions.csv") 
distributionPerHour16 <- read_csv("../4.Data/TL3Data/distributionValues/distributionPerHour16.csv")
distributionPerSegment16 <- read_csv("../4.Data/TL3Data/distributionValues/distributionPerSegment16.csv")
distributionSumation16 <- read_csv("../4.Data/TL3Data/distributionValues/distributionSumation16.csv")
sotCodingSheet16 <- read_csv("../4.Data/TL3Data/sotCodingSheets/cleanedSotCodingSheet16.csv") 
clusterValue <- read_csv("../4.Data/TL3Data/clusterData/correctPercentilesClusters.csv")
TL3MetadataRenamed <- read_csv("../4.Data/TL3Data/Metadata/TL3data_Renamed.csv")
giniCoefficients <- read_csv("../4.Data/TL3Data/gini/giniCoef.csv")
```


# Getting Descriptives for recording length
```{r}


```


```{r}
# readyForGeorge <- merge(sotCodingSheet16, TL3MetadataRenamed, by = "SUBJECT") %>% 
#   mutate(EXCLUDE = replace_na(EXCLUDE, "NA"),
#           TrueNaps = replace_na(TrueNaps, "NA"),
#            DNL = replace_na(DNL, "NA" )) %>%
#   filter(EXCLUDE != 1) %>% 
#   filter(DNL != 1) %>% 
#   filter(TrueNaps != 1)
#   
# 
# readyForGeorge <- readyForGeorge %>% 
#   rename(id = SUBJECT, months_age = Age,	time = Time, dur_min = Duration,	meaningful_min = Meaningful, distant_min = Distant,	tv_min	= TV, noise_min = Noise,	silence_min = Silence, 	sex = SEX,	mom_ed = MOM_YRS_EDU, hi = SES) %>% 
#   mutate( dur_min = dur_min/60) %>% 
#   distinct(id,	months_age,	time,	dur_min,	meaningful_min,	distant_min,	tv_min,	noise_min,	silence_min,	AWC	,CTC,	CVC, sex,	mom_ed,	hi) 
# 
# 
# 
# write_csv(readyForGeorge, "forGeorgeEnglish.csv")
```


```{r, echo = FALSE, message = FALSE}
child_dist_per_hour.ordered <- function(df, na.rm = TRUE, ...){
  
  # create list of counties in data to loop over 
  subject_list <- unique(distributionPerHour16$SUBJECT)
  # create for loop to produce ggplot2 graphs 
  for (i in seq_along(subject_list)) { 
    
    # create plot for each subject in df 
    cur_df <- df %>% 
      filter(SUBJECT == subject_list[i])
    
    plot <- 
      ggplot(cur_df, aes( x = as.numeric(reorder(hour_bin, clean_total_awc)),
                          y = as.numeric(clean_total_awc) )) +
      ylim(0.0, 7000.0) +
    geom_bar(stat = "identity",position = "dodge") +
      theme_gray() +
      ggtitle(paste( "Subject", subject_list[i], 'Hourly Caregiver Talk',
                    sep=''))
    # save plots as .png
    # ggsave(plot, file=paste(results, 
    #                        'projection_graphs/county_graphs/',
    #                        county_list[i], ".png", sep=''), scale=2)
   
    # save plots as .pdf
    # ggsave(plot, file=paste(results, 
    #                        'projection_graphs/county_graphs/',
    #                        county_list[i], ".pdf", sep=''), scale=2)
    
    # print plots to screen
    print(plot)
  }
}

child_dist_per_hour.unordered <- function(df, na.rm = TRUE, ...){
  
  # create list of counties in data to loop over 
  subject_list <- unique(distributionPerHour16$SUBJECT)
  # create for loop to produce ggplot2 graphs 
  for (i in seq_along(subject_list)) { 
    
    # create plot for each subject in df 
    cur_df <- df %>% 
      filter(SUBJECT == subject_list[i])
    
    plot <- 
      ggplot(cur_df, aes( x = hour_bin,
                          y = clean_total_awc)) +
      ylim(0.0, 7000.0) +
    geom_bar(stat = "identity",position = "dodge") +
      theme_gray() +
      ggtitle(paste( "Subject", subject_list[i], 'Hourly Caregiver Talk',
                    sep=''))
    # save plots as .png
    # ggsave(plot, file=paste(results, 
    #                        'projection_graphs/county_graphs/',
    #                        county_list[i], ".png", sep=''), scale=2)
   
    # save plots as .pdf
    # ggsave(plot, file=paste(results, 
    #                        'projection_graphs/county_graphs/',
    #                        county_list[i], ".pdf", sep=''), scale=2)
    
    # print plots to screen
    print(plot)
  }
}

child_dist_per_seg.ordered <- function(df, na.rm = TRUE, ...){
  
  # create list of counties in data to loop over 
  subject_list <- unique(distributionPerHour16$SUBJECT)
  # create for loop to produce ggplot2 graphs 
  for (i in seq_along(subject_list)) { 
    
    # create plot for each subject in df 
    
    cur_df <- df %>% 
      filter(SUBJECT == subject_list[i])
    
    plot <- 
      ggplot(cur_df, aes( x = as.numeric(reorder(Time, AWC)),
                          y = as.numeric(AWC) )) +
    geom_bar(stat = "identity",position = "dodge") +
      theme_gray() +
      ggtitle(paste( "Subject ", subject_list[i], ' Per Segment Caregiver Talk',
                    sep=''))
    # save plots as .png
    # ggsave(plot, file=paste(results, 
    #                        'projection_graphs/county_graphs/',
    #                        county_list[i], ".png", sep=''), scale=2)
   
    # save plots as .pdf
    # ggsave(plot, file=paste(results, 
    #                        'projection_graphs/county_graphs/',
    #                        county_list[i], ".pdf", sep=''), scale=2)
    
    # print plots to screen
    print(plot)
  }
}

child_dist_per_seg.unordered <- function(df, na.rm = TRUE, ...){
  
  # create list of counties in data to loop over 
  subject_list <- unique(distributionPerHour16$SUBJECT)
  # create for loop to produce ggplot2 graphs 
  for (i in seq_along(subject_list)) { 
    
    # create plot for each subject in df 
    cur_df <- df %>% 
      filter(SUBJECT == subject_list[i])
    
    plot <- 
      ggplot(cur_df, aes( x = as.numeric(Time),
                          y = as.numeric(AWC) )) +
      ylim(0.0, 500.0) +
    geom_bar(stat = "identity",position = "dodge") +
      theme_gray() +
      ggtitle(paste( "Subject ", subject_list[i], ' Per Segment Caregiver Talk',
                    sep=''))
    # save plots as .png
    # ggsave(plot, file=paste(results, 
    #                        'projection_graphs/county_graphs/',
    #                        county_list[i], ".png", sep=''), scale=2)
   
    # save plots as .pdf
    # ggsave(plot, file=paste(results, 
    #                        'projection_graphs/county_graphs/',
    #                        county_list[i], ".pdf", sep=''), scale=2)
    
    # print plots to screen
    print(plot)
  }
}

```

# Investigating Daily Talk in the Lives of English- and Spanish-Speaking Children

In this ongoing study we ask ourselves how much child-directed speech is enough to:

- Have a larger vocabulary
- Have faster language processing speed 

## Things We Do Know

There are many studies that show that caregivers who verbally engage more with their children have children who demonstrate stronger later language skills, including vocabulary growth and language processing efficiency (Hart & Risley, 1985; Cartmill et al., 2013; Weisleder & Fernald, 2013). However, something that has yet to be investigated is how the distribution of child directed speech contibutes to a child's overall language learning. Many studies characterize qualitative differences of children's language environments as differences in average number of words overheard that day. However, we invesitigate that it could be the case that these averages mask certain nuances with which the spread/distribution of child directed speech contributed to a child's language learning.





# A Day in the Life of a Child...(on average)

A childs day to day unordered AWC profile would look something like this. Where time is in military time just for the simplicity in plotting. We do see that it is very variable and also has a large window of talk, starting from 8 am to about 7pm. With AWC ranging from 0 words to 667 words within a 5 minute window. 

```{r, echo = FALSE, message = FALSE}  
subjectExample <- sotCodingSheet16 %>% 
  filter(SUBJECT == 12717)

ggplot(subjectExample, aes( x = Time, y = AWC )) +
    geom_bar(stat = "identity",position = "dodge") +
      theme_gray() +
      ggtitle("Subject 11003 Profile of Segment Caregiver Talk")
```



```{r, echo = FALSE, message = FALSE}
talkFrequency <- distributionSumation16 %>% 
  group_by(hour_bin) %>% 
   mutate(unclean_avg_awc_across_all_subjects = mean(unclean_total_awc),
         unclean_avg_cvc_across_all_subjects = mean(unclean_total_cvc),
         unclean_avg_ctc_across_all_subjects = mean(unclean_total_ctc)) %>% 
  
  mutate(clean_avg_awc_across_all_subjects = mean(clean_total_awc),
         clean_avg_cvc_across_all_subjects = mean(clean_total_cvc),
         clean_avg_ctc_across_all_subjects = mean(clean_total_ctc)) %>% 
  distinct(hour_bin, unclean_avg_awc_across_all_subjects, unclean_avg_cvc_across_all_subjects,
           unclean_avg_ctc_across_all_subjects, clean_avg_awc_across_all_subjects, clean_avg_cvc_across_all_subjects
           ,clean_avg_ctc_across_all_subjects )
```


# So, where is talk happening?
First we have the unclean LENA histogram across all subjects.
Observations:

- There are two big dense periods throughout the day
- These periods are in the morning and in the evening, maybe due to parents coming and going from work?


```{r, echo = FALSE, message = FALSE}
ggplot(talkFrequency, aes(x = hour_bin,y = unclean_avg_awc_across_all_subjects)) +
    geom_bar(stat = "identity",position = "dodge") +
  theme_gray()


# ggplot(talkFrequency, aes(x = hour_bin,y = unclean_avg_ctc_across_all_subjects)) +
#     geom_bar(stat = "identity",position = "dodge") +
#   theme_gray()
# 
# ggplot(talkFrequency, aes(x = hour_bin,y = unclean_avg_cvc_across_all_subjects)) +
#     geom_bar(stat = "identity",position = "dodge") +
#   theme_gray()
```
## Cleaning for Naps

Cleaning for naps is basically getting rid of all instances where the child is sleeping.
This decision was made as for the two samples which we are comparing, the Spanish group turned off the recorders when the child slept or sometimes for some window within the day. So, to make it comparible we get rid of instances when children are sleeping and/or napping. 

# Mean AWC with Standard Deviation of Mean AWC

The first plot is unclean mean awc X unclean standard deviation. These are measures for AWC without cleaning for naps.

The second plot is clean mean awc X clean standard deviation.

```{r, echo = FALSE, message = FALSE}
ggplot(distributionPerHour16, aes(unclean_mean_awc, unclean_sd_awc))+
  geom_point() +
   geom_smooth(method = "lm")

ggplot(distributionPerHour16, aes(clean_mean_awc, clean_sd_awc))+
  geom_point() +
   geom_smooth(method = "lm")
```





```{r, echo = FALSE, message = FALSE}
# # Plotting mean CTC with Std Dev CTC
# The first plot is unclean mean ctc X unclean ctc standard deviation. This are measures for ctc without cleaning for naps.
# The second plot is clean mean ctc X clean ctc standard deviation.
# #Then, we will plot each, but first we will need to reshape the data frame into a long format
# ggplot(distributionPerSegment16, aes(unclean_mean_ctc, unclean_sd_ctc))+
#   geom_point()+
#    geom_smooth(method = "lm")
# 
# ggplot(distributionPerSegment16, aes(clean_mean_ctc, clean_sd_ctc))+
#   geom_point()+
#    geom_smooth(method = "lm")
```


```{r, echo = FALSE, message = FALSE}
## Plotting mean CVC with Std Dev CVC
# 
# The first plot is unclean mean CVC X unclean CVC standard deviation. This are measures for CVC without cleaning for naps.
# 
# The second plot is clean mean CVC X clean CVC standard deviation.
# #Then, we will plot each, but first we will need to reshape the data frame into a long format
# ggplot(distributionPerSegment16, aes(unclean_mean_cvc, unclean_sd_cvc))+
#   geom_point()+
#    geom_smooth(method = "lm")
# 
# ggplot(distributionPerSegment16, aes(clean_mean_cvc, clean_sd_cvc))+
#   geom_point()+
#    geom_smooth(method = "lm")
```



```{r, echo = FALSE, message = FALSE}
#Then, we will plot each, but first we will need to reshape the data frame into a long format
# ggplot(distributionPerHour16, aes(unclean_mean_awc, unclean_sd_awc))+
#   geom_point()+
#    geom_smooth(method = "lm")
# 
# ggplot(distributionPerHour16, aes(clean_mean_awc, clean_sd_awc))+
#   geom_point()+
#    geom_smooth(method = "lm")
```

```{r, echo = FALSE, message = FALSE }
# #Then, we will plot each, but first we will need to reshape the data frame into a long format
# ggplot(distributionPerHour16, aes(unclean_mean_ctc, unclean_sd_ctc))+
#   geom_point()
# 
# ggplot(distributionPerHour16, aes(clean_mean_ctc, clean_sd_ctc))+
#   geom_point()
```

```{r, echo = FALSE, message = FALSE }
#Then, we will plot each, but first we will need to reshape the data frame into a long format
# ggplot(distributionPerHour16, aes(unclean_mean_cvc, unclean_sd_cvc))+
#   geom_point()
# 
# ggplot(distributionPerHour16, aes(clean_mean_cvc, clean_sd_cvc))+
#   geom_point()'
```



```{r, echo = FALSE, message = FALSE}
# Next we have the clean LENA histograms across all subjects. We have AWC, CTC, and CVC. 
# Observations:
# 
# - Similarly, here are two big dense periods throughout the day
# - These periods are in the morning and in the evening, maybe due to parents coming and going from work.
# ggplot(talkFrequency, aes(x = hour_bin,y = clean_avg_awc_across_all_subjects)) +
#     geom_bar(stat = "identity",position = "dodge") +
#   theme_gray()
# 
# ggplot(talkFrequency, aes(x = hour_bin,y = clean_avg_ctc_across_all_subjects)) +
#     geom_bar(stat = "identity",position = "dodge") +
#   theme_gray()
# 
# ggplot(talkFrequency, aes(x = hour_bin,y = clean_avg_cvc_across_all_subjects)) +
#     geom_bar(stat = "identity",position = "dodge") +
#   theme_gray()
```




```{r, echo = FALSE, message = FALSE}
# child_dist_per_hour.ordered(distributionSumation16)
## what is the difference between top hour and bottom hour? and what is the mean/proportion maximal difference between hours. 



```

```{r, echo = FALSE, message = FALSE}
# child_dist_per_hour.unordered(distributionSumation16)
## what is the difference between top hour and bottom hour? and what is the mean/proportion maximal difference between hours. 
```


```{r, echo = FALSE, message = FALSE}
# child_dist_per_seg.ordered(sotCodingSheet16)

## fix the squigily graph

# is there a relationship between how steep your curve is and the avereage,
# Do steeper people have a higher average overall?
# You have people who are bursty, if you are bursty, do you have a higher average overall or can we decouple burstyness? 
# Are there pockets of time while the rest is not as intense.
# Can you be low overall but still be bursty?
# Average, steepness, and burstyness. 

# child_dist_per_seg.unordered(sotCodingSheet16)

```

```{r, echo = FALSE, message = FALSE}
# child_dist_per_seg.unordered(sotCodingSheet16)

## fix the squigily graph

# is there a relationship between how steep your curve is and the avereage,
# Do steeper people have a higher average overall?
# You have people who are bursty, if you are bursty, do you have a higher average overall or can we decouple burstyness? 
# Are there pockets of time while the rest is not as intense.
# Can you be low overall but still be bursty?


# Average, steepness, and burstyness. 

```

# Proportional Drop
Proportional drop was a measure we came up with to measure variance in the child's moment-to-moment language environment.
In a list of AWCs, orderd from smalled to largest where $AWC_i \geq AWC_{i=1}$, for a single child, proportional drop for two single observations can be seen as $P\Delta = 1 - AWC_{i-1}/AWC_i$ where $AWC_{i-1}/AWC_i$ is the percentage of AWC from one drop to the other. And, so to see the proportional drop we take $1 - AWC_{i-1}/AWC_i$ to get the proportional difference between the $i^{th}$ and $i^{th}-1$. 

We used two measures:

- average proportional drop across the day
- max drop throughout the day

Observations: 
  We saw that every child had at least two contiguous segments with the same AWC count. Thus, all children had a mininum drop of 0.
  

```{r, echo = FALSE, message = FALSE}
#Loading in overall proportional difference.
subjectPropDrop <- segProp16 %>% 
  group_by(SUBJECT) %>% 
  mutate(propDrop = 1-prop) %>% 
  mutate(avgPropDrop = mean(propDrop), maxPropDrop = max(propDrop), minPropDrop = min(propDrop)) %>% 
  distinct(avgPropDrop, maxPropDrop, minPropDrop)

segmentalDist16 <- merge(subjectPropDrop, distributionPerSegment16, by = 'SUBJECT')
```

Here we see the histogram proportional drop across the entire day as well as a summary of its statistics.

```{r, echo = FALSE, message = FALSE}
hist(subjectPropDrop$avgPropDrop)
summary(subjectPropDrop$avgPropDrop)
```

Here are side by side graphs of average proportional drop against clean mean AWC and standard deviation AWC.

```{r, echo = FALSE, message = FALSE}
pdXcma <- ggplot(segmentalDist16, aes(x = avgPropDrop, y = clean_mean_awc))+
  geom_point() + 
  geom_smooth(method = "lm")

pdXcsda <- ggplot(segmentalDist16, aes(x = avgPropDrop, y = clean_sd_awc))+
  geom_point() + 
  geom_smooth(method = "lm")

grid.arrange(pdXcma, pdXcsda, ncol=2)

```

Here are side by side graphs of max proportional drop against clean mean AWC and standard deviation AWC.
We see that they are not correlated at all and so at this point we decided to leave the measure alone.

```{r, echo = FALSE, message = FALSE}
mxpXcma <- ggplot(segmentalDist16, aes(x = maxPropDrop, y = clean_mean_awc))+
  geom_point() + 
  geom_smooth(method = "lm")

mxpXcsda <- ggplot(segmentalDist16, aes(x = maxPropDrop, y = clean_sd_awc))+
  geom_point() + 
  geom_smooth(method = "lm")


grid.arrange(mxpXcma, mxpXcsda, ncol=2)

```



```{r, echo = FALSE, message = FALSE}

#some people can be steepy and low and some people can be steepy and high
#some people can be grad and low and some people can be grad and high
#What does all day AWC mean?? High awc means ppl talk all the time??? nah, it's just an average accross the day
#people are variable from moment to moment and talk about the shape of the overall dist, with bursty and gradual people
#some people have a biggere difference on average between each 5 minute segment
#DREW ABNEY (LITERATURE ON BURSTYNESS)
#START A TIMELINE FOR DEADLINES
#SRCD BI ANNUAL CONFERENCE ABOUT FAMILY MATTERS 
#start back, from the start with AWC and what it means.
#then get to the peakyness and awc 
#go back to the casillas paper, with how can people learn from nothing? 
#the nothing is defined from very low talk (on average)
#are there peaks of intense language?

#where we are at is not an easy place to be at, so use some graphics and make it easier to understand!cisc
#Then, we will plot each, but first we will need to reshape the data frame into a long format

# 
# ggplot(distributionPerSegment16, aes(unclean_mean_ctc, unclean_sd_ctc))+
#   geom_point()
# 
# ggplot(distributionPerSegment16, aes(clean_mean_ctc, clean_sd_ctc))+
#   geom_point()
# 
# ggplot(distributionPerSegment16, aes(x = reorder(SUBJECT, clean_mean_ctc),y = clean_mean_ctc)) +
#     geom_bar(stat = "identity",position = "dodge") +
#   geom_errorbar(width=.1, aes(ymin=clean_mean_ctc-clean_sd_ctc, ymax=clean_mean_ctc+clean_sd_ctc)) +
#   theme_gray()
# 
# english <- sotCodingSheet16 %>% 
#   replace_na(list(Exclude = "keep")) %>% 
#   replace_na(list(DNL = "0")) %>% 
#   replace_na(list(Sleep = "0"))
# 
# date_seq <- english %>% 
#   group_by(SUBJECT, Date) %>% 
#   distinct(Date) %>% 
#   group_by(SUBJECT) %>% 
#   arrange(Date) %>% 
#   mutate(date_seq = seq_len(n()))
# 
# english2 <- english %>% 
#   full_join(date_seq, by = c("SUBJECT", "Date"))
# 
# 
# hours_rec_uncleaned_full_recording <- english2 %>% 
#   group_by(SUBJECT) %>% 
#   mutate(hours_rec_uncleaned_full_recording = sum(Duration)/3600) %>% 
#   distinct(SUBJECT, hours_rec_uncleaned_full_recording)
# 
# ggplot(hours_rec_uncleaned_full_recording, aes(hours_rec_uncleaned_full_recording)) + 
#   geom_histogram() 
# 
# english <- english %>% 
#  filter(SUBJECT < 911000)
# 
# ggplot(english, aes(Time, SUBJECT)) +
#   geom_point()
```

# Clustering Measures

As we saw before, the language landscape of a child is very variable throughout the day. So how to we simplify this? 

```{r, echo = FALSE, message = FALSE}  
subjectExample <- sotCodingSheet16 %>% 
  filter(SUBJECT == 11003)

ggplot(subjectExample, aes( x = Time, y = AWC )) +
    geom_bar(stat = "identity",position = "dodge") +
      theme_gray() +
      ggtitle("Subject 11003 Profile of Segment Caregiver Talk")
```


To find periods of dense talk, we identified the highest 30% of AWC segments for each family, and then applied a k-means clustering algorithm to identify one or more consecutive 5 minute segments that were similar in AWC (i.e., clusters of talk).

```{r, echo = FALSE, message = FALSE}
subjectExample <- sotCodingSheet16 %>% 
  filter(SUBJECT == 11003) %>% 
  filter(AWC >= quantile(sotCodingSheet16$AWC, probs = c(.7)))

ggplot(subjectExample, aes( x = Time, y = AWC )) +
    geom_bar(stat = "identity",position = "dodge") +
      theme_gray() +
      ggtitle("Subject 11003 70th Percentile Profile of Segment Caregiver Talk")

```

Thus, it simplifies the work we have to do by only looking at the top 30th percentile of AWCs for each child and also helps us better see the amounts of peaks a child has throughout the day. So when we run a kmeans custering algorithm, we run it on these top 30th percentile awcs for each child respectively.

# K-Means Clustering
k-means clustering is a method of vector quantization, originally from signal processing, that aims to partition n observations into k clusters in which each observation belongs to the cluster with the nearest mean (cluster centers or cluster centroid), serving as a prototype of the cluster. 

Given a set of observations $(x_1, x_2, ..., x_n)$, where each observation is a d-dimensional real vector, k-means clustering aims to partition the $n$ observations into $k (\leq n)$ sets $S = {S_1, S_2, ..., S_k}$ so as to minimize the within-cluster sum of squares (WCSS) (i.e. variance). Formally, the objective is to find:

${\displaystyle {\underset {\mathbf {S} }{\operatorname {arg\,min} }}\sum _{i=1}^{k}\sum _{\mathbf {x} \in S_{i}}\left\|\mathbf {x} -{\boldsymbol {\mu }}_{i}\right\|^{2}={\underset {\mathbf {S} }{\operatorname {arg\,min} }}\sum _{i=1}^{k}|S_{i}|\operatorname {Var} S_{i}}$

Using the K-means clustering approach, where a cluster can be 1 point alone, we found these statistics.

- Range(0, 35) in the number of clusters found for each child. We are currently investigating why this number is so high.
- Mean number of of clusters is approximately 13.9.
- Average cluster Size (i.e. duration) was 2.07 (Less Constrained 1.257422). This means that each cluster was approximately 10 minutes long.

To take into account differences in recording length, which had a range of 5 to 12 full hours (clean), we made the number of clusters a rate per hour. Current statistics are as follows:

- Mean: 1.413 clusters per hour.  (Less Constrained 2.165808)
- Median: 1.352 clusters per hour


Clusters per hour turned out to correlate significantly with Mean AWC and Standard Deviation of Average AWC. 


```{r, echo = FALSE, message = FALSE}



clusterAndDistrubtionMeasures <- merge(clusterValue, distributionPerHour16, by = 'SUBJECT')

clusterAndDistrubtionMeasures <- clusterAndDistrubtionMeasures %>% 
  mutate(clusterPerHr = nclusters/clean_total_hrs, 
         avgClusterDensityPerHr = avgClusterDensity/clean_total_hrs) 


hist(clusterAndDistrubtionMeasures$nclusters)


mean(clusterAndDistrubtionMeasures$clusterPerHr)



clusterAndDistrubtionMeasures <- merge(clusterAndDistrubtionMeasures, TL3MetadataRenamed, by = 'SUBJECT')


clusterAndDistrubtionMeasures <- merge(clusterAndDistrubtionMeasures,giniCoefficients, by = 'SUBJECT')



clusterPerHourXMeanAWC <- ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_mean_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: .02438293 ; P=0.8584")

cor.test(clusterAndDistrubtionMeasures$clusterPerHr, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson"))

clusterPerHourXSTDAWC <- ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_sd_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.108544; P= 0.4259")
cor.test(clusterAndDistrubtionMeasures$clusterPerHr, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson"))

grid.arrange(clusterPerHourXMeanAWC, clusterPerHourXSTDAWC, ncol=2)
```


```{r, echo = FALSE, message = FALSE}



nClustersXMeanAWC <- ggplot(clusterAndDistrubtionMeasures, aes(nclusters, clean_mean_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.08926946 ; P=0.5129")

cor.test(clusterAndDistrubtionMeasures$nclusters, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson"))

nClustersXSTDAWC <- ggplot(clusterAndDistrubtionMeasures, aes(nclusters, clean_sd_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.1414994; P= 0.2106")
cor.test(clusterAndDistrubtionMeasures$nclusters, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson"))

grid.arrange(nClustersXMeanAWC, nClustersXSTDAWC, ncol=2)
```


```{r, echo = FALSE, message = FALSE}



minClusterSizeXMeanAWC <- ggplot(clusterAndDistrubtionMeasures, aes(clean_sd_awc, clean_mean_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.7879963 ; P= 5.725e-13")

cor.test(clusterAndDistrubtionMeasures$minClusterAWC, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson"))

minClusterSizeXSTDAWC <- ggplot(clusterAndDistrubtionMeasures, aes(minClusterAWC, clean_sd_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.6071274; P= 7.018e-07")
cor.test(clusterAndDistrubtionMeasures$minClusterAWC, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson"))

grid.arrange(minClusterSizeXMeanAWC, ncol=1)
```

```{r, echo = FALSE, message = FALSE}



maxClusterAWCXMeanAWC <- ggplot(clusterAndDistrubtionMeasures, aes(maxClusterAWC, clean_mean_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.6993586 ; P= 2.024e-09")

cor.test(clusterAndDistrubtionMeasures$maxClusterAWC, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson"))

maxClusterAWCXSTDAWC <- ggplot(clusterAndDistrubtionMeasures, aes(maxClusterAWC, clean_sd_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.7191573; P= 4.285e-10")
cor.test(clusterAndDistrubtionMeasures$maxClusterAWC, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson"))

grid.arrange(maxClusterAWCXMeanAWC, maxClusterAWCXSTDAWC, ncol=2)
```



```{r, echo = FALSE, message = FALSE}



avgClusterDensityXMeanAWC <- ggplot(clusterAndDistrubtionMeasures, aes(avgClusterDensity, clean_mean_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.8235943 ; P= 6.536e-15")

cor.test(clusterAndDistrubtionMeasures$avgClusterDensity, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson"))

avgClusterDensityXSTDAWC <- ggplot(clusterAndDistrubtionMeasures, aes(avgClusterDensity, clean_sd_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: 0.6860307; P= 5.375e-09")
cor.test(clusterAndDistrubtionMeasures$avgClusterDensity, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson"))

grid.arrange(avgClusterDensityXMeanAWC, avgClusterDensityXSTDAWC, ncol=2)
```


Average cluster size was found not to correlate with AWC or number of clusters as we see below.

```{r, echo = FALSE, message = FALSE}

a <- ggplot(clusterAndDistrubtionMeasures, aes(avgClustersize , clean_mean_awc))+
  geom_point() +
  geom_smooth(method = "lm")

# cor.test(clusterAndDistrubtionMeasures$avgclustersize, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson"))



b <- ggplot(clusterAndDistrubtionMeasures, aes(avgClustersize, nclusters))+
  geom_point() +
  geom_smooth(method = "lm(formula = y ~ log(x)")

# cor.test(clusterAndDistrubtionMeasures$avgclustersize, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson"))


grid.arrange(b, ncol=1)
```


<!-- ## Where Each Cluster Must Have at Least Two Points.  -->

<!-- We discussed whether allowing clusters to have at least 1 one point was not capturing the dense moments of talk we were looking for. So, as a comparison, we re-ran the clustering algorithm to only allow clusters of size 2 or greater and this is what we found.  -->

<!-- Using the K-means clustering approach, where a cluster must be at least 2 points, we found these statistics. -->

<!-- - Range, (0, 15) in the number of clusters found for each child.  -->
<!-- - Mean number of clusters is approximately 5.267 for each child. -->
<!-- - Average cluster Size (i.e. duration) was 6.02. This means that each cluster was approximately 30 minutes long. -->

<!-- To take into account differences in recording length, which had a range of 5 to 12 full hours (clean), we made the number of clusters a rate per hour. Current statistics are as follows: -->

<!-- - Mean: 0.548 clusters per hour. -->
<!-- - Median: 0.576 clusters per hour -->


<!-- ```{r, echo = FALSE, message = FALSE} -->


<!-- clusterPerHourXMeanAWC <- ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHrMin2, clean_mean_awc))+ -->
<!--   geom_point() + -->
<!--   geom_smooth(method = "lm")+ -->
<!--   labs(caption = "Cor: 0.574; P<.001") -->

<!-- #cor.test(clusterAndDistrubtionMeasures$clusterPerHrMin2, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson")) -->

<!-- clusterPerHourXSTDAWC <- ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHrMin2, clean_sd_awc))+ -->
<!--   geom_point() + -->
<!--   geom_smooth(method = "lm")+ -->
<!--   labs(caption = "Cor: 0.433; P<.001") -->

<!-- #cor.test(clusterAndDistrubtionMeasures$clusterPerHrMin2, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson")) -->

<!-- grid.arrange(clusterPerHourXMeanAWC, clusterPerHourXSTDAWC, ncol=2) -->
<!-- ``` -->


<!-- Now, we see that for clusters for minimum size 2, average cluster size is related to mean hourly awc.  -->

<!-- ```{r, echo = FALSE, message = FALSE} -->



<!-- c <- ggplot(clusterAndDistrubtionMeasures, aes(avgClusterDensity, clean_mean_awc))+ -->
<!--   geom_point() + -->
<!--   geom_smooth(method = "lm") +  -->
<!--   labs(caption = "Cor: 0.466; P<.001") -->

<!-- cor.test(clusterAndDistrubtionMeasures$avgClusterDensity, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson")) -->


<!-- d <- ggplot(clusterAndDistrubtionMeasures, aes(avgClusterDensity, clean_sd_awc))+ -->
<!--   geom_point() + -->
<!--   geom_smooth(method = "lm")+ -->
<!--   labs(caption = "Cor: 0.358; P<.01") -->

<!-- cor.test(clusterAndDistrubtionMeasures$avgClusterDensity, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson")) -->


<!-- grid.arrange(c, d, ncol=2) -->
<!-- ``` -->

<!-- # Looking at the AWC Density for Clusters!  -->

<!-- We have previously looked at duration of clusters and also number of clusters per hour. Now allow us to see how the density or size of the clusters with respect with their AWC relates to other measures! -->

<!-- ```{r, echo = FALSE, message = FALSE} -->

<!-- c <- ggplot(clusterAndDistrubtionMeasures, aes(minClusterAWC , clean_mean_awc))+ -->
<!--   geom_point() + -->
<!--   geom_smooth(method = "lm") +  -->
<!--   labs(caption = "Cor: 0.466; P<.001") -->

<!-- # cor.test(clusterAndDistrubtionMeasures$avgclustersize2Min, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson")) -->


<!-- d <- ggplot(clusterAndDistrubtionMeasures, aes(minClusterAWC, clean_sd_awc))+ -->
<!--   geom_point() + -->
<!--   geom_smooth(method = "lm")+ -->
<!--   labs(caption = "Cor: 0.358; P<.01") -->


<!-- # cor.test(clusterAndDistrubtionMeasures$avgclustersize2Min, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson")) -->


<!-- <!-- grid.arrange(c, d, ncol=2) --> -->
<!-- <!-- ``` --> -->
<!-- ```{r, echo = FALSE, message = FALSE} -->

<!-- c <- ggplot(clusterAndDistrubtionMeasures, aes(maxClusterAWC , clean_mean_awc))+ -->
<!--   geom_point() + -->
<!--   geom_smooth(method = "lm") +  -->
<!--   labs(caption = "Cor: 0.466; P<.001") -->

<!-- # cor.test(clusterAndDistrubtionMeasures$avgclustersize2Min, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson")) -->


<!-- d <- ggplot(clusterAndDistrubtionMeasures, aes(maxClusterAWC, clean_sd_awc))+ -->
<!--   geom_point() + -->
<!--   geom_smooth(method = "lm")+ -->
<!--   labs(caption = "Cor: 0.358; P<.01") -->


<!-- # cor.test(clusterAndDistrubtionMeasures$avgclustersize2Min, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson")) -->


<!-- grid.arrange(c, d, ncol=2) -->
<!-- ``` -->

# Introducing the Gini Coefficient

The Gini Coefficient is a measure of inequality in a frequency distribution (mostly used for income). The value can range from 0, the most equal, to 1 the most unequal. For example a gini coefficient of 1 for a child would represent a child who hears all the child directed speech they will hear in a given day, durring one of the 5-minute periods. 

# Relating the Gini Coefficient to AWC 

We see that the Gini Coefficient is correlated with daily AWC. This means that as the input across the day becomes more equal for a given child, we also expect them to have heard less speech during the day per hour. This agrees with what we said previously, as the more variable talk is across the day, the more words we expect the child to hear across an entire day.

```{r, echo = FALSE, message = FALSE}



GiniXMeanAWC <- ggplot(clusterAndDistrubtionMeasures, aes(gini, clean_mean_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: -0.418; P=.001")

# cor.test(clusterAndDistrubtionMeasures$gini, clusterAndDistrubtionMeasures$clean_mean_awc, method = c("pearson"))

GiniXSTDAWC <- ggplot(clusterAndDistrubtionMeasures, aes(gini, clean_sd_awc))+
  geom_point() +
  geom_smooth(method = "lm")+
  labs(caption = "Cor: -0.11; P = .391")

# cor.test(clusterAndDistrubtionMeasures$gini, clusterAndDistrubtionMeasures$clean_sd_awc, method = c("pearson"))

grid.arrange(GiniXMeanAWC, GiniXSTDAWC, ncol=2)
```


Next, we want to look at how these measures predict to later language outcomes. 

# Clusters Against Vocabulary Size, Reaction Time, and Accuracy 3 Months Later.

Children’s vocabulary size was assessed using the MacArthur-Bates Communicative Development Inventories (CDI) in English (Fenson et al. 2007) or Spanish (Jackson-Maldonado et al., 2003). This is a parent survey asking how many common words the child knows at 15 months. Children’s language processing efficiency was assessed in the Looking-While-Listening task (Fernald et al., 2006). Here, children are present with two pictures, a target and a distraction. Both are on opposite sides of a monitor. A voice says, 'Can you see the ____'. And so, the elapsed time it takes the child to look at the target picture from the distraction is the Reaction Time (RT) and Accuracy reflects the proportion of time fixating on the named picture. 


## First, we predict to all outcome measures from Clusters per Hour

### Predicting to CDI

```{r, echo = FALSE, message = FALSE}
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_mean_awc))+
#   geom_point() +
#   geom_smooth(method = "lm")
# 
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_sd_awc))+
#   geom_point() +
#    geom_smooth(method = "lm")

clean_mean_awcXCDI <- ggplot(clusterAndDistrubtionMeasures, aes(clean_mean_awc, CDI_18C18C_WG))+
  geom_point() +
  geom_smooth(method = "lm") +
   ggtitle("MEAN AWC") +
  xlab("MeanAWC") + ylab("CDI at 18 Months")


clusterPerHrXCDI <- ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, CDI_18C18C_WG))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("clusterPHR") +
  xlab("Clusters/Hour ~ 16 Months") + ylab("CDI at 18 Months")

minClusterAWCXCDIrXRT <- ggplot(clusterAndDistrubtionMeasures, aes(minClusterAWC, CDI_18C18C_WG))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("MinClusterAWC") +
  xlab("MinClusterAWC ~ 16 Months") + ylab("CDI at 18 Months")


grid.arrange(clean_mean_awcXCDI,clusterPerHrXCDI, minClusterAWCXCDIrXRT, ncol=3)
```


```{r, echo = FALSE, message = FALSE}
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_mean_awc))+
#   geom_point() +
#   geom_smooth(method = "lm")
# 
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_sd_awc))+
#   geom_point() +
#    geom_smooth(method = "lm")

maxClusterSizeXCDI <- ggplot(clusterAndDistrubtionMeasures, aes(maxClusterAWC, CDI_18C18C_WG))+
  geom_point() +
  geom_smooth(method = "lm") +
   ggtitle("max Cluster Size") +
  xlab("max Cluster Size") + ylab("CDI at 18 Months")


avgClusterDenistyXCDI <- ggplot(clusterAndDistrubtionMeasures, aes(avgClusterDensity, CDI_18C18C_WG))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("Avg Cluster Density") +
  xlab("Avg Cluster Density") + ylab("CDI at 18 Months")

giniXCDI<- ggplot(clusterAndDistrubtionMeasures, aes(gini, CDI_18C18C_WG))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("Gini") +
  xlab("Gini") + ylab("CDI at 18 Months")


grid.arrange(maxClusterSizeXCDI,avgClusterDenistyXCDI, giniXCDI, ncol=3)
```



```{r, echo = FALSE, message = FALSE}
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_mean_awc))+
#   geom_point() +
#   geom_smooth(method = "lm")
# 
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_sd_awc))+
#   geom_point() +
#    geom_smooth(method = "lm")

clean_mean_awcXACC_1818 <- ggplot(clusterAndDistrubtionMeasures, aes(clean_mean_awc, ACC_1818))+
  geom_point() +
  geom_smooth(method = "lm") +
   ggtitle("MEAN AWC") +
  xlab("MeanAWC") + ylab("Acc at 18 Months")


clusterPerHrXACC_1818 <- ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, ACC_1818))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("clusterPHR") +
  xlab("Clusters/Hour ~ 16 Months") + ylab("Acc at 18 Months")

minClusterAWCXACC_1818 <- ggplot(clusterAndDistrubtionMeasures, aes(minClusterAWC, ACC_1818))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("MinClusterAWC") +
  xlab("MinClusterAWC ~ 16 Months") + ylab("Acc at 18 Months")


grid.arrange(clean_mean_awcXACC_1818,clusterPerHrXACC_1818, minClusterAWCXACC_1818, ncol=3)
```


```{r, echo = FALSE, message = FALSE}
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_mean_awc))+
#   geom_point() +
#   geom_smooth(method = "lm")
# 
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_sd_awc))+
#   geom_point() +
#    geom_smooth(method = "lm")

maxClusterSizeXACC_1818 <- ggplot(clusterAndDistrubtionMeasures, aes(maxClusterAWC, ACC_1818))+
  geom_point() +
  geom_smooth(method = "lm") +
   ggtitle("Max Cluster Size") +
  xlab("Max Cluster Size") + ylab("Acc at 18 Months")


avgClusterDenistyXACC_1818 <- ggplot(clusterAndDistrubtionMeasures, aes(avgClusterDensity, ACC_1818))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("avgClusterDensity") +
  xlab("avg Cluster Density") + ylab("Acc at 18 Months")

giniXACC_1818 <- ggplot(clusterAndDistrubtionMeasures, aes(gini, ACC_1818))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("Gini") +
  xlab("Gini") + ylab("Acc at 18 Months")


grid.arrange(maxClusterSizeXACC_1818,avgClusterDenistyXACC_1818, giniXACC_1818, ncol=3)
```






```{r, echo = FALSE, message = FALSE}
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_mean_awc))+
#   geom_point() +
#   geom_smooth(method = "lm")
# 
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_sd_awc))+
#   geom_point() +
#    geom_smooth(method = "lm")

clean_mean_awcXRT18A18C_NO1RT<- ggplot(clusterAndDistrubtionMeasures, aes(clean_mean_awc, RT18A18C_NO1RT))+
  geom_point() +
  geom_smooth(method = "lm") +
   ggtitle("MEAN AWC") +
  xlab("MeanAWC") + ylab("RT at 18 Months")


clusterPerHrXRT18A18C_NO1RT <- ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, RT18A18C_NO1RT))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("clusterPHR") +
  xlab("Clusters/Hour ~ 16 Months") + ylab("RT at 18 Months")

minClusterAWCXRT18A18C_NO1RT <- ggplot(clusterAndDistrubtionMeasures, aes(minClusterAWC, RT18A18C_NO1RT))+
  geom_point() +
   geom_smooth(method = "lm")+
  ggtitle("MinClusterAWC") +
  xlab("MinClusterAWC ~ 16 Months") + ylab("RT at 18 Months")


grid.arrange(clean_mean_awcXRT18A18C_NO1RT,clusterPerHrXRT18A18C_NO1RT, minClusterAWCXRT18A18C_NO1RT, ncol=3)
```
### Min Cluster AWC 

```{r, echo = FALSE, message = FALSE}
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_mean_awc))+
#   geom_point() +
#   geom_smooth(method = "lm")
# 
# ggplot(clusterAndDistrubtionMeasures, aes(clusterPerHr, clean_sd_awc))+
#   geom_point() +
#    geom_smooth(method = "lm")

 NClustersPerHourXCDI<- ggplot(clusterAndDistrubtionMeasures, aes(gini, CDI_18C18C_WG))+
  geom_point() +
  geom_smooth(method = "lm")+
  xlab("Gini") + ylab("CDI")


NClustersPerHourXRT <- ggplot(clusterAndDistrubtionMeasures, aes(gini, RT18A18C_NO1RT))+
  geom_point() +
   geom_smooth(method = "lm")+
  xlab("Gini") + ylab("RT")

NClustersPerHourXCDI
NClustersPerHourXRT
```


From these graphs we see that clusters/hour was significantly correlated with Accuracy and CDI score (p<.01). Critically, clusters/hour accounted for an additional 15% of the variance in CDI scores, after controlling for AWC (p = 0.012). It is important to note though that Mean AWC per Hour accounted for the majority of the variance for both Accuracy and Reaction Time. **Cluster Measures where clusters had to have a minimum size of 2 did not out preform the other cluster measures. In addition, GINI coefficient, although it correlated with other measures, it did not out preform Clusters nor did it out preform mean hourly AWC.**



These results demonstrate that in addition to overall amount of talk, understanding dense periods of talk over the day provides a more nuanced view of the patterns of talk to young children. Importantly, the amount of dense talk provides additional predictive power when accounting for children's outcomes. Ongoing analyses of Spanish-speaking families will investigate if similar trends can be replicated in families from a different cultural and linguistic group. 





```{r}
meaningfulDifferences <- clusterAndDistrubtionMeasures %>% 
  distinct(SUBJECT, clean_mean_awc, clusterPerHr, gini, CDI_18C18C_WG,RT18A18C_NO1RT, ACC_1818) %>% 
  rename(CDI = CDI_18C18C_WG, RT= RT18A18C_NO1RT, ACC =ACC_1818 )

summary(meaningfulDifferences$ACC)
sd(meaningfulDifferences$ACC)



awcCor <- clusterAndDistrubtionMeasures %>% 
  distinct(clean_mean_awc, CDI_18C18C_WG,RT18A18C_NO1RT, ACC_1818) %>% 
  rename(CDI = CDI_18C18C_WG, RT= RT18A18C_NO1RT, ACC =ACC_1818 )
```

```{r}

library(faraway)
library(ggplot2)


AWC_to_Accuracy <- resid(lm(data=meaningfulDifferences, ACC ~ clean_mean_awc))
clustersPerHour_to_AWC <- resid(lm(data=meaningfulDifferences, clusterPerHr ~ clean_mean_awc))
resid <- data.frame(expend_resid,total_resid)
ggplot(resid, aes(x=clustersPerHour_to_AWC, y=AWC_to_Accuracy)) +
         geom_point()+
    geom_smooth(method = "lm") +
  ggtitle(label = "Partial Regression Plot"
              ,subtitle = "Effect of adding Clusters per hour") + 
   xlab("Clusters per Hour ~ AWC/Hr") + ylab("Accuracy ~ AWC/Hr")
  



AWC_to_Accuracy <- resid(lm(data=meaningfulDifferences, ACC ~ clean_mean_awc))
clustersPerHour_to_AWC <- resid(lm(data=meaningfulDifferences, gini ~ clean_mean_awc))
resid <- data.frame(expend_resid,total_resid)
ggplot(resid, aes(x=clustersPerHour_to_AWC, y=AWC_to_Accuracy)) +
         geom_point()+
    geom_smooth(method = "lm") +
  ggtitle(label = "Partial Regression Plot"
              ,subtitle = "Effect of adding Gini") + 
   xlab("Gini ~ AWC/Hr") + ylab("Accuracy ~ AWC/Hr")

cor(AWC_to_Accuracy, clustersPerHour_to_AWC)

AWC_to_Accuracy <- resid(lm(data=meaningfulDifferences, RT ~ clean_mean_awc))
clustersPerHour_to_AWC <- resid(lm(data=meaningfulDifferences, clusterPerHr ~ clean_mean_awc))
resid <- data.frame(expend_resid,total_resid)
ggplot(resid, aes(x=clustersPerHour_to_AWC, y=AWC_to_Accuracy)) +
         geom_point()+
    geom_smooth(method = "lm") +
  ggtitle(label = "Partial Regression Plot"
              ,subtitle = "Effect of adding Clusters per hour") + 
   xlab("Clusters per Hour ~ AWC/Hr") + ylab("Reaction Time ~ AWC/Hr")
  



AWC_to_Accuracy <- resid(lm(data=meaningfulDifferences, RT ~ clean_mean_awc))
clustersPerHour_to_AWC <- resid(lm(data=meaningfulDifferences, gini ~ clean_mean_awc))
resid <- data.frame(expend_resid,total_resid)
ggplot(resid, aes(x=clustersPerHour_to_AWC, y=AWC_to_Accuracy)) +
         geom_point()+
    geom_smooth(method = "lm") +
  ggtitle(label = "Partial Regression Plot"
              ,subtitle = "Effect of adding Gini") + 
   xlab("Gini ~ AWC/Hr") + ylab("Reaction Time  ~ AWC/Hr")




ggplot(meaningfulDifferences, aes(clusterPerHr, CDI)) +
  geom_point() +
   ggtitle(label = "Clusters Per Hour and CDI",
              subtitle = "English-Speaking Children") +
  geom_smooth(method = "lm")+
  xlab("Clusters/Hour") + ylab("CDI")

ggplot(meaningfulDifferences, aes(gini, CDI)) +
  geom_point() +
   ggtitle(label = "Gini and CDI",
              subtitle = "English-Speaking Children") +
  geom_smooth(method = "lm") +
  xlab("Gini") + ylab("Accuracy")

ggplot(meaningfulDifferences, aes(gini, RT)) +
  geom_point() +
   ggtitle(label = "Gini and RT",
              subtitle = "English-Speaking Children") +
  geom_smooth(method = "lm") +
  xlab("Gini") + ylab("Reaction Time")

ggplot(meaningfulDifferences, aes(clusterPerHr, RT)) +
  geom_point() +
   ggtitle(label = "Clusters Per Hour and RT",
              subtitle = "English-Speaking Children") +
  geom_smooth(method = "lm") +
  xlab("Clusters/Hour") + ylab("Reaction Time")

sd(meaningfulDifferences$clusterPerHr)
 # distinct(SUBJECT, nclusters,clusterPerHr,minClusterAWC,maxClusterAWC, avgClustersize, avgClusterDensity,avgClusterDensityPerHr, gini, unclean_total_hrs, clean_total_hrs, unclean_mean_awc, clean_mean_awc, clean_sd_awc, CDI_18C18C_WG,RT18A18C_NO1RT, ACC_1818)
```



```{r}
cor.test(meaningfulDifferences$nclusters, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$clusterPerHr, meaningfulDifferences$CDI, method =c("pearson"))
cor.test(meaningfulDifferences$minClusterAWC, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$maxClusterAWC, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$avgClustersize, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$avgClusterDensity, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$gini, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$clean_mean_awc, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$clean_sd_awc, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))


cor.test(meaningfulDifferences$nclusters, meaningfulDifferences$ACC_1818, method =c("pearson"))
cor.test(meaningfulDifferences$clusterPerHr, meaningfulDifferences$ACC_1818, method =c("pearson"))
cor.test(meaningfulDifferences$minClusterAWC, meaningfulDifferences$ACC_1818, method =c("pearson"))
cor.test(meaningfulDifferences$maxClusterAWC, meaningfulDifferences$ACC_1818, method =c("pearson"))
cor.test(meaningfulDifferences$avgClustersize, meaningfulDifferences$ACC_1818, method =c("pearson"))
cor.test(meaningfulDifferences$avgClusterDensity, meaningfulDifferences$ACC_1818, method =c("pearson"))
cor.test(meaningfulDifferences$gini, meaningfulDifferences$ACC_1818, method =c("pearson"))
cor.test(meaningfulDifferences$clean_mean_awc, meaningfulDifferences$ACC_1818, method =c("pearson"))
cor.test(meaningfulDifferences$clean_sd_awc, meaningfulDifferences$ACC_1818, method =c("pearson"))



cor.test(meaningfulDifferences$nclusters, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))
cor.test(meaningfulDifferences$clusterPerHr, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))
cor.test(meaningfulDifferences$minClusterAWC, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))
cor.test(meaningfulDifferences$maxClusterAWC, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))
cor.test(meaningfulDifferences$avgClustersize, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))
cor.test(meaningfulDifferences$avgClusterDensity, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))
cor.test(meaningfulDifferences$gini, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))
cor.test(meaningfulDifferences$clean_mean_awc, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))
cor.test(meaningfulDifferences$clean_sd_awc, meaningfulDifferences$RT18A18C_NO1RT, method =c("pearson"))




```






```{r,  echo = FALSE, message = FALSE}
cor.test(meaningfulDifferences$nclusters, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$clusterPerHr, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$minClusterAWC, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$maxClusterAWC, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$avgClustersize, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$avgClusterDensity, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$gini, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$clean_mean_awc, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))
cor.test(meaningfulDifferences$clean_sd_awc, meaningfulDifferences$CDI_18C18C_WG, method =c("pearson"))


# # #predicting to cdi
model1 = lm(ACC_1818 ~ clean_mean_awc , data = clusterAndDistrubtionMeasures)
summary(model1)

model2 = lm(ACC_1818 ~ clean_mean_awc*clean_sd_awc, data = clusterAndDistrubtionMeasures)
summary(model2)


model2 = lm(ACC_1818 ~ clean_mean_awc*clusterPerHr, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(ACC_1818 ~ clean_mean_awc*avgClustersize, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(ACC_1818 ~ clean_mean_awc*minClusterAWC, data = clusterAndDistrubtionMeasures)
summary(model2)


model2 = lm(ACC_1818 ~ clean_mean_awc*maxClusterAWC, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(ACC_1818 ~ clean_mean_awc*avgClusterDensity, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(ACC_1818 ~ clean_mean_awc*gini, data = clusterAndDistrubtionMeasures)
summary(model2)


# 
# #predicting to RT
# model1 = lm(RT18A18C_NO1RT ~ avgclustersize2Min , data = clusterAndDistrubtionMeasures)
# summary(model1)
model1 = lm(RT18A18C_NO1RT ~ clean_mean_awc , data = clusterAndDistrubtionMeasures)
summary(model1)

model2 = lm(RT18A18C_NO1RT ~ clean_mean_awc + clean_sd_awc, data = clusterAndDistrubtionMeasures)
summary(model2)


model2 = lm(RT18A18C_NO1RT ~ clean_mean_awc + clusterPerHr, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(RT18A18C_NO1RT ~ clean_mean_awc + avgClustersize, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(RT18A18C_NO1RT ~ clean_mean_awc + minClusterAWC, data = clusterAndDistrubtionMeasures)
summary(model2)


model2 = lm(RT18A18C_NO1RT ~ clean_mean_awc + maxClusterAWC, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(RT18A18C_NO1RT ~ clean_mean_awc + avgClusterDensity, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(RT18A18C_NO1RT ~ clean_mean_awc + gini, data = clusterAndDistrubtionMeasures)
summary(model2)
# #predicting to ACC
# model1 = lm(ACC_1818 ~ avgclustersize2Min , data = clusterAndDistrubtionMeasures)
# summary(model1)
model1 = lm(ACC_1818 ~ clean_mean_awc , data = clusterAndDistrubtionMeasures)
summary(model1)

model2 = lm(ACC_1818 ~ clean_mean_awc + clean_sd_awc, data = clusterAndDistrubtionMeasures)
summary(model2)


model2 = lm(ACC_1818 ~ clean_mean_awc + clusterPerHr, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(ACC_1818 ~ clean_mean_awc + avgClustersize, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(ACC_1818 ~ clean_mean_awc + minClusterAWC, data = clusterAndDistrubtionMeasures)
summary(model2)


model2 = lm(ACC_1818 ~ clean_mean_awc + maxClusterAWC, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(ACC_1818 ~ clean_mean_awc + avgClusterDensity, data = clusterAndDistrubtionMeasures)
summary(model2)

model2 = lm(ACC_1818 ~ clean_mean_awc + gini, data = clusterAndDistrubtionMeasures)
summary(model2)
# 

# # 
cor.test(clusterAndDistrubtionMeasures$clean_mean_awc, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
cor.test(clusterAndDistrubtionMeasures$clean_mean_awc, clusterAndDistrubtionMeasures$RT18A18C_NO1RT, method = c("pearson"))
cor.test(clusterAndDistrubtionMeasures$clean_mean_awc, clusterAndDistrubtionMeasures$ACC_1818, method = c("pearson"))

cor.test(clusterAndDistrubtionMeasures$minClusterAWC, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
cor.test(clusterAndDistrubtionMeasures$minClusterAWC, clusterAndDistrubtionMeasures$RT18A18C_NO1RT, method = c("pearson"))
cor.test(clusterAndDistrubtionMeasures$minClusterAWC, clusterAndDistrubtionMeasures$ACC_1818, method = c("pearson"))


cor.test(clusterAndDistrubtionMeasures$maxPropDrop, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
cor.test(clusterAndDistrubtionMeasures$maxPropDrop, clusterAndDistrubtionMeasures$ACC_1818, method = c("pearson"))
cor.test(clusterAndDistrubtionMeasures$maxPropDrop, clusterAndDistrubtionMeasures$RT18A18C_NO1RT, method = c("pearson"))


cor.test(clusterAndDistrubtionMeasures$clean_sd_awc, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
cor.test(clusterAndDistrubtionMeasures$clean_sd_awc, clusterAndDistrubtionMeasures$ACC_1818, method = c("pearson"))
cor.test(clusterAndDistrubtionMeasures$clean_sd_awc, clusterAndDistrubtionMeasures$RT18A18C_NO1RT, method = c("pearson"))


cor.test(clusterAndDistrubtionMeasures$avgClusterDensity, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
cor.test(clusterAndDistrubtionMeasures$avgClusterDensity, clusterAndDistrubtionMeasures$ACC_1818, method = c("pearson"))
cor.test(clusterAndDistrubtionMeasures$avgClusterDensity, clusterAndDistrubtionMeasures$RT18A18C_NO1RT, method = c("pearson"))

cor.test(clusterAndDistrubtionMeasures$avgclustersize, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
cor.test(clusterAndDistrubtionMeasures$avgclustersize, clusterAndDistrubtionMeasures$ACC_1818, method = c("pearson"))
cor.test(clusterAndDistrubtionMeasures$avgclustersize, clusterAndDistrubtionMeasures$RT18A18C_NO1RT, method = c("pearson"))

cor.test(clusterAndDistrubtionMeasures$clusterPerHr, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))
cor.test(clusterAndDistrubtionMeasures$clusterPerHr, clusterAndDistrubtionMeasures$ACC_1818, method = c("pearson"))
cor.test(clusterAndDistrubtionMeasures$clusterPerHr, clusterAndDistrubtionMeasures$RT18A18C_NO1RT, method = c("pearson"))

cor.test(clusterAndDistrubtionMeasures$gini, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
cor.test(clusterAndDistrubtionMeasures$gini, clusterAndDistrubtionMeasures$ACC_1818, method = c("pearson"))
cor.test(clusterAndDistrubtionMeasures$gini, clusterAndDistrubtionMeasures$RT18A18C_NO1RT, method = c("pearson"))

cor.test(clusterAndDistrubtionMeasures$minClusterAWC, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
cor.test(clusterAndDistrubtionMeasures$clusterPerHr, clusterAndDistrubtionMeasures$CDI_18C18C_WG, method =c("pearson"))#
#



#predicting to cdi
# model1 = lm(CDI_18C18C_WG ~ clean_mean_awc , data = clusterAndDistrubtionMeasures)
# summary(model1)
# 
# model2 = lm(CDI_18C18C_WG ~ clean_mean_awc*clusterPerHr  , data = clusterAndDistrubtionMeasures)
# summary(model2)
# # 
# #predicting to ACC
# model1 = lm( ACC_1818~ clean_mean_awc , data = clusterAndDistrubtionMeasures)
# summary(model1)
# 
# model2 = lm(ACC_1818 ~ clean_mean_awc*clusterPerHr, data = clusterAndDistrubtionMeasures)
# summary(model2)
# # 
# # 
# # #predicting to RT
# model1 = lm( RT18A18C_NO1RT~ clean_mean_awc , data = clusterAndDistrubtionMeasures)
# summary(model1)
# 
# model2 = lm(RT18A18C_NO1RT ~ clean_mean_awc + minClusterAWC, data = clusterAndDistrubtionMeasures)
# summary(model2)


```

